geom_col(position = "dodge2") +
scale_fill_viridis_d() +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 25, hjust = 0.85)) +
labs(
title = "Proportion of Congregations for 2009, 2022",
y = "Proportion\n\n",
fill = "Year"
)
ggplot(prop_12, aes(
x = TRAD12,
y = PROPORTION,
fill = factor(YEAR))) +
ylim(0, .4) +
geom_col(position = "dodge2") +
scale_fill_viridis_d() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(angle = 25, hjust = 0.85)) +
labs(
title = "Proportion of Congregations for 2009, 2022",
y = "Proportion\n\n",
fill = "Year"
)
bp_1.2 <- ggplot(prop_12, aes(
x = TRAD12,
y = PROPORTION,
fill = factor(YEAR))) +
ylim(0, .4) +
geom_col(position = "dodge2") +
scale_fill_viridis_d() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(angle = 25, hjust = 0.85)) +
labs(
title = "Proportion of Congregations for 2009, 2022",
y = "Proportion\n\n",
fill = "Year"
)
ggsave("bar_plot_1.2.pdf", bp_1.2,
width = 10, height = 5, units = "in")
ggsave("bar_plot_1.2.pdf", bp_1.2,
width = 12, height = 5, units = "in")
bp_1.1
bp_2.1 <- ggplot(data, aes(x = TRAD6, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
scale_fill_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Congregation"
) +
facet_wrap(~TRAD6)
bp_2.1
source("~/Desktop/Programs/Git/DataViz_2026/problemSets/PS02/my_answers/PS02_SVU.r")
source("~/Desktop/Programs/Git/DataViz_2026/problemSets/PS02/my_answers/PS02_SVU.r")
bp_1.1
bp_1.2
bp_2.1
box_plot
ridges_together
ggplot(data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == 1),
aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
xlim(0, 6000000) +
scale_fill_viridis_d() +
scale_color_viridis_d()
ggplot(data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == 1),
aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
ggplot(data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == 1),
aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(
plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
ggplot(data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == 1),
aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(
plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
dev.off()
dev.off()
ggplot(data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == 1),
aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(
plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
ggsave("ridges_together.pdf", ridges_together,
width = 10, height = 5, units = "in")
### Question 3.2
ridges_above <- data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == 1)
ggplot(ridges_above, aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
view(ridges_above)
### Question 3.2
ridges_above <- data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == '1')
view(ridges_above)
view(data)
### Question 3.2
ridges_above <- data %>% filter(!is.na(AVG_INCOME), YEAR == 2022, AVG_INCOME == 'Above Average')
ggplot(ridges_above, aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
ggsave("ridges_above.pdf", ridges_above_plot,
width = 10, height = 5, units = "in")
ridges_above_plot <- ggplot(ridges_above, aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Above Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
ggsave("ridges_above.pdf", ridges_above_plot,
width = 10, height = 5, units = "in")
ridges_below <- data %>% filter(!is.na(AVG_INCOME), YEAR == 2022,
AVG_INCOME == 'Below Average')
ridges_below_plot <- ggplot(ridges_below, aes(
x = INCOME,
y = GDREGION,
fill = GDREGION,
color = GDREGION)) +
geom_density_ridges(alpha = 0.7) +
theme(plot.title = element_text(hjust = 0.5)) +
labs(x = "Income",
y = "Region",
title = "Yearly Incomes by Region (2022, Below Average)") +
scale_fill_viridis_d() +
scale_color_viridis_d()
ggsave("ridges_below.pdf", ridges_below_plot,
width = 10, height = 5, units = "in")
box_plot
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6) +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Congregation"
) +
ylim(0, 10000) +
annotate("text", label = "Note: certain outliers not captured", x = 6.5, y = 10000) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Congregation"
) +
ylim(0, 10000) +
annotate("text", label = "Note: certain outliers not captured", x = 6.5, y = 10000) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Congregation"
) +
annotate("text", label = "Note: certain outliers not captured", x = 6.5, y = 10000) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Congregation"
) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Congregation",
color = element_blank()
) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
guides(color = "none") +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Congregation"
) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Religion"
) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
scale_color_manual(name = "Religion",
labels = c("Chrétiennes", "Juives", "Musulmanes")
) +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Religion"
) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
scale_color_viridis_d() +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
scale_color_manual(name = "Religion",
labels = c("Chrétiennes", "Juives", "Musulmanes"),
values = c("#440154", "#21918c", "#fde725")) +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Religion"
) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
box_plot_wrapped <- ggplot(data, aes(x = GDREGION, y = NUMOFFMBR, fill = TRAD6, color = TRAD6)) +
geom_boxplot() +
scale_fill_viridis_d(alpha = 0.7) +
theme(axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5)) +
facet_wrap(~TRAD6, scales = "free_y") +
scale_color_manual(name = "Religion",
labels = c("Chrétiennes", "Juives", "Musulmanes"),
values = c("#440154", "#21918c", "#fde725")) +
labs(
title = "Congregational Member Counts (2022)",
y = "Number of Official Members",
fill = "Religion"
) +
theme(axis.text.x = element_text(angle = 25, hjust = 1))
box_plot_wrapped
ggsave("box_plot_wrapped.pdf", box_plot_wrapped,
width = 10, height = 5, units = "in")
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5)
) +
labs(
title = "Number of Official Members by Religious Tradition (2022)",
x = "12-level Religious Classification (TRAD12)",
y = "Number of Official Members"
)
bp_2.2
bp_2.1
bp_2.2
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5)
) +
labs(
title = "Number of Official Members by Religion (2022)\n\n",
x = "12-level Religious Classification (TRAD12)",
y = "Number of Official Members"
)
bp_2.2
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5)
) +
labs(
title = "Number of Official Members by Religion (2022)\N\N",
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5)
) +
labs(
title = "Number of Official Members by Religion (2022)\n\n",
x = "12-level Religious Classification (TRAD12)",
y = "Number of Official Members"
)
bp_2.2
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5)
) +
labs(
title = "Number of Official Members by Religion (2022)\n",
x = "12-level Religious Classification (TRAD12)",
y = "Number of Official Members\n\n\n"
)
bp_2.2
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5)
) +
labs(
title = "Number of Official Members by Religion (2022)\n",
x = "12-level Religious Classification (TRAD12)",
y = "Number of Official Members\n\n\n",
fill = "Congregation"
)
bp_2.2
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5),
panel.spacing = unit(1.5, "lines"),
panel.border = element_rect(color = "grey20", fill = NA, linewidth = 0.8)
) +
labs(
title = "Number of Official Members by Religion (2022)\n",
x = "12-level Religious Classification (TRAD12)",
y = "Number of Official Members\n\n\n",
fill = "Congregation"
)
bp_2.2
ggsave("bar_plot_2.2.pdf", bp_2.2,
width = 10, height = 5, units = "in")
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6) +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5),
panel.spacing = unit(1.5, "lines"),
panel.border = element_rect(color = "grey20", fill = NA, linewidth = 0.8)
) +
labs(
title = "Number of Official Members by Religion (2022)\n",
x = "",
y = "Number of Official Members\n\n\n",
fill = "Congregation"
)
ggsave("bar_plot_2.2.pdf", bp_2.2,
width = 10, height = 5, units = "in")
box_plot_wrapped
bp_2.2
#Question 2.2
bp_2.2 <- ggplot(data %>% filter(YEAR == 2022),
aes(x = TRAD12, y = NUMOFFMBR, fill = TRAD12)) +
geom_col(position = "dodge") +
facet_wrap(~ TRAD6, scales = "free_y") +
scale_fill_viridis_d() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5),
panel.spacing = unit(1.5, "lines"),
panel.border = element_rect(color = "grey20", fill = NA, linewidth = 0.8)
) +
labs(
title = "Number of Official Members by Religion (2022)\n",
x = "",
y = "Number of Official Members\n\n\n",
fill = "Congregation"
)
bp_2.2
ggsave("bar_plot_2.2.pdf", bp_2.2,
width = 10, height = 5, units = "in")
